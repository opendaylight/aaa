#/bin/sh

################################################################################
#
#  Script to install AAA artifacts into a given Opendaylight controller.
#
#  If running, the controller may need to be restarted after this script is run.
#
################################################################################

# Opendaylight controller installation directory
ODL="$1"
PLUGINS="$ODL/plugins"

# Libraries
LIBS="org.apache.oltu.oauth2.common-1.0.0.jar org.apache.oltu.oauth2.authzserver-1.0.0.jar org.apache.oltu.oauth2.resourceserver-1.0.0.jar ehcache-2.8.2.jar"

function usage() {
  echo "usage: $(basename $0) <Opendaylight controller installation directory> [skipLibs]" >&2 && exit 1
}

[ $# -lt 1 ] && usage

JARS=$(find . -name "aaa-*.jar")

# Copy AAA files
for i in $JARS; do
  cp -f $i $PLUGINS
done

# Copy library files (optional)
[ $# -eq 1 ] && for i in $LIBS; do
  jar=$(find ~/.m2/repository -name "$i")
  [ -f $jar ] && cp -f $jar $PLUGINS
done

